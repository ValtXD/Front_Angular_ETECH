<div class="ocr-full-page-container">
  <button class="back-to-upload-button" (click)="voltarParaUpload()">
    <i class="material-icons">arrow_back</i> Voltar para Upload
  </button>

  <div class="ocr-list-card">
    <div class="card-header-section">
      <h1 class="ocr-list-title">Leituras OCR</h1>
      <p class="ocr-list-subtitle">Visualize e gerencie todas as leituras de contadores</p>
    </div>

    <hr class="divider"> <div class="filters-section">
    <h3 class="filters-title">Filtros</h3>
    <div class="filters-row">
      <div class="custom-select-wrapper">
        <select [(ngModel)]="filtroEstadoId" name="filtroEstado" class="custom-select">
          <option [value]="null">Todos os Estados</option>
          <option *ngFor="let estado of estados" [value]="estado.id">
            {{ estado.nome }}
          </option> </select>
        <span class="custom-select-arrow"></span>
      </div>

      <div class="custom-select-wrapper">
        <select [(ngModel)]="filtroAno" name="filtroAno" class="custom-select">
          <option value="">Todos os Anos</option>
          <option *ngFor="let ano of anos" [value]="ano">{{ ano }}</option>
        </select>
        <span class="custom-select-arrow"></span>
      </div>

      <div class="custom-select-wrapper">
        <select [(ngModel)]="filtroMes" name="filtroMes" class="custom-select">
          <option *ngFor="let mesOp of meses" [value]="mesOp.value">{{ mesOp.label }}</option>
        </select>
        <span class="custom-select-arrow"></span>
      </div>

      <button (click)="aplicarFiltro()" class="apply-filter-button">
        Aplicar Filtro
      </button>
    </div>
  </div>

    <hr class="divider"> <div class="list-section">
    <div class="list-header">
      <h3 class="list-title">Lista de Leituras</h3>
      <span class="found-readings-count" *ngIf="leituras.length > 0">{{ leituras.length }} leituras encontradas</span>
    </div>

    <div class="readings-table-container" *ngIf="leituras.length > 0">
      <table>
        <thead>
        <tr>
          <th>DATA</th>
          <th>ESTADO</th>
          <th>VALOR EXTRAÍDO</th>
          <th>VALOR CORRIGIDO</th>
          <th>CUSTO ESTIMADO</th>
          <th>IMAGEM</th>
          <th>AÇÕES</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let leitura of leituras">
          <td>{{ leitura.data_registro | date:'shortDate' }} {{ leitura.data_registro | date:'shortTime' }}</td>
          <td>{{ leitura.estado?.nome }}</td>
          <td>R$ {{ leitura.valor_extraido | number:'1.2-2' }}</td>
          <td>R$ {{ leitura.valor_corrigido | number:'1.2-2' }}</td>
          <td>R$ {{ leitura.custo_total | number:'1.2-2' }}</td>
          <td>
            <img *ngIf="leitura.imagem_url" [src]="getImagemUrl(leitura.imagem_url)" alt="Imagem da Leitura" class="reading-thumbnail">
            <span *ngIf="!leitura.imagem_url">Sem Imagem</span>
          </td>
          <td>
            <button class="action-button delete-button" (click)="confirmarRemocao(leitura.id)">
              <i class="material-icons">delete</i>
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="leituras.length === 0" class="no-data-full-message">
      <p>Nenhuma leitura encontrada</p>
      <p class="no-data-subtext">Aplique filtros diferentes ou faça upload de novas leituras</p>
    </div>
  </div>
  </div>
</div>
