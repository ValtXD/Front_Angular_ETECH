<div class="upload-wrapper">
  <h1 class="title">Upload do Documento</h1>

  <div class="info-box">
    <p>
      Envie um arquivo Excel (.xlsx, .xls) ou Word (.docx) com colunas corretas.<br />
      <strong>Aparelhos:</strong> "Aparelho", "Potencia(W)", "HorasPorDia".<br />
      <strong>Contador:</strong> "Data" (YYYY-MM) e "LeituraDoMes(kWh)".
    </p>
  </div>

  <!-- Templates -->
  <div class="template-section">
    <h2 class="subtitle">Download de Templates</h2>
    <div class="template-grid">
      <div class="template-card">
        <h3><i class="fas fa-file-invoice"></i> Template de Contador</h3>
        <button (click)="baixarTemplate('contador', 'xlsx')">
          <i class="fas fa-file-excel"></i> Excel
        </button>
        <button (click)="baixarTemplate('contador', 'docx')">
          <i class="fas fa-file-word"></i> Word
        </button>
      </div>

      <div class="template-card">
        <h3><i class="fas fa-plug"></i> Template de Aparelhos</h3>
        <button (click)="baixarTemplate('aparelho', 'xlsx')">
          <i class="fas fa-file-excel"></i> Excel
        </button>
        <button (click)="baixarTemplate('aparelho', 'docx')">
          <i class="fas fa-file-word"></i> Word
        </button>
      </div>
    </div>
  </div>

  <!-- Upload -->
  <div class="upload-box">
    <label class="upload-button">
      <i class="fas fa-cloud-upload-alt"></i> Selecione o Arquivo
      <input type="file" (change)="onArquivoChange($event)" accept=".xlsx,.xls,.docx" />
    </label>
    <span class="file-name">{{ arquivo?.name || 'Nenhum arquivo selecionado' }}</span>
  </div>

  <!-- Carregando -->
  <div *ngIf="carregando" class="loading">
    <i class="fas fa-circle-notch fa-spin"></i> Processando arquivo...
  </div>

  <!-- Erros -->
  <div *ngIf="erros.length" class="error-box">
    <h4><i class="fas fa-exclamation-circle"></i> Erros:</h4>
    <ul>
      <li *ngFor="let erro of erros">{{ erro }}</li>
    </ul>
  </div>

  <!-- Preview Aparelhos -->
  <div *ngIf="tipoDocumento === 'aparelho' && dados.length" class="preview">
    <h4><i class="fas fa-eye"></i> Preview Aparelhos</h4>
    <table>
      <thead>
      <tr>
        <th>Aparelho</th>
        <th>Potência (W)</th>
        <th>Horas por Dia</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of dados">
        <td>{{ item.aparelho }}</td>
        <td>{{ item.potencia_w }}</td>
        <td>{{ item.horas_por_dia }}</td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Preview Contador -->
  <div *ngIf="tipoDocumento === 'contador' && dados.length" class="preview">
    <h4><i class="fas fa-eye"></i> Preview Contador</h4>
    <table>
      <thead>
      <tr>
        <th>Data</th>
        <th>Leitura (kWh)</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of dados">
        <td>{{ item.data }}</td>
        <td>{{ item.leitura_kwh }}</td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Botão de Resultado -->
  <button
    [disabled]="!dados.length || erros.length > 0"
    [ngClass]="{ 'disabled': !dados.length || erros.length > 0 }"
    (click)="irParaResultados()"
  >
    <i class="fas fa-arrow-right"></i> Ir para Resultados
  </button>
</div>
